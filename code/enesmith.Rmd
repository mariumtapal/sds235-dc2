---
title: "enesmith"
author: "Elisabeth Nesmith"
date: "3/13/2021"
output: html_document
---
```{r}
library(tidyverse)
library(raster)
library(ggplot2)
library(plotly)
```

```{r}
#load in friday movement data
park_movement_Fri <- read.csv("~/Downloads/SDS 235/DC2-data/Movement Data/park-movement-Fri.csv")

park_movement_Sun <- read.csv("~/Downloads/SDS 235/DC2-data/Movement Data/park-movement-Sun.csv")
```


```{r}
#filtering top 1 most frequent id from lauren's rmd
important_ids_Fri <- park_movement_Fri %>% 
  filter(id == 331284)
```

```{r}
# map most frequent id on friday
# Charge the image as an R object with the "JPEG" package
library(jpeg)
library(png)
my_image <- readJPEG("Park Map.jpg")

# Set up a plot area with no plot
xcoord <- park_movement_Fri$X
ycoord <- park_movement_Fri$Y
plot(x = xcoord, y = ycoord, type='n', main="", xlab="x", ylab="y")

# Get the plot information so the image will fill the plot box, and draw it
lim <- par()
rasterImage(my_image, 
            xleft=0, xright=100, 
            ybottom=0, ytop=100)
grid()
 
#Add your plot !
points(
  x= important_ids_Fri$X, 
  y= important_ids_Fri$Y, 
  type="b", lwd=5, col="black")
```

```{r}
#find most frequent ids on Sunday
frequent_id_sun <- park_movement_Sun %>%
  group_by(id) %>%
  count(id, sort = TRUE) %>% 
  filter(n > 2500)
frequent_id_sun
```

```{r}
#filter for top id
important_ids_Sun<- park_movement_Sun %>% 
  filter(id == 1529852)
```


```{r}
# map most frequent id on Sunday
# Charge the image as an R object with the "JPEG" package
library(jpeg)
library(png)
my_image <- readJPEG("Park Map.jpg")

# Set up a plot area with no plot
xcoord <- park_movement_Sun$X
ycoord <- park_movement_Sun$Y
plot(x = xcoord, y = ycoord, type='n', main="", xlab="x", ylab="y")

# Get the plot information so the image will fill the plot box, and draw it
lim <- par()
rasterImage(my_image, 
            xleft=0, xright=100, 
            ybottom=0, ytop=100)
grid()
 
#Add your plot !
points(
  x= important_ids_Sun$X, 
  y= important_ids_Sun$Y, 
  type="b", lwd=5, col="black")
```

More ideas
- filter by time (based on timeframe most communications happened)
- filter by area (based on parts of park near where the crime happened?)
  - Scott scheduled to appear on stage (number 63 on map) and memorabilia displayed in pavillion (number 32 on map)



