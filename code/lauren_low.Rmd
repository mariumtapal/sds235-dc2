---
title: "Lauren Low's analysis"
output: html_document
---

```{r}
library(moveVis)
library(move)
library(raster)
library(ggplot2)
library(tidyverse)
library(plotly)
```

```{r loading files}
park_movement_Fri <- read.csv("/Users/llow/Desktop/visual analytics/dc2/DC2-data/Movement Data/park-movement-Fri.csv")
```


```{r}
grouped <- park_movement_Fri %>%
  group_by(id) %>%
  summarize(Timestamp, type, X, Y)
grouped
```

```{r}
frequent_id <- park_movement_Fri %>%
  group_by(id) %>%
  count(id, sort = TRUE) %>%
  filter(n > 3000)
frequent_id
```

```{r}
frequent_id <- ggplot(data = frequent_id, aes(x = reorder(id, n), y = n)) +
  geom_bar(stat = "identity")
frequent_id
```


```{r}

data("move_data", package = "moveVis") # move class object
# if your tracks are present as data.frames, see df2move() for conversion

# align move_data to a uniform time scale
m <- align_move(move_data, res = 4, unit = "mins")

# create spatial frames with a OpenStreetMap watercolour map
frames <- frames_spatial(m, path_colours = c("red", "green", "blue"),
                         map_service = "osm", map_type = "watercolor", alpha = 0.5) %>%
  add_labels(x = "Longitude", y = "Latitude") %>% # add some customizations, such as axis labels
  add_northarrow() %>%
  add_scalebar() %>%
  add_timestamps(m, type = "label") %>%
  add_progress()

frames[[100]] # preview one of the frames, e.g. the 100th frame

# animate frames
animate_frames(frames, out_file = "moveVis.gif")
```


```{r}
unique(timestamps(move_data))
timeLag(move_data, unit = "mins")

move_data <- align_move(move_data, res = 4, unit = "mins")

frames <- frames_spatial(move_data, path_colours = c("red", "green", "blue"),
                         map_service = "osm", map_type = "watercolor", alpha = 0.5)

length(frames) # number of frames
frames[[100]] # display one of the frames


```


